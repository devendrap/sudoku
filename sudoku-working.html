<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku Solver</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #f0f0f0;
        }

        h1 {
            color: #663399;
            margin-bottom: 20px;
        }

        #sudoku-grid {
            display: grid;
            grid-template-columns: repeat(9, 50px);
            grid-template-rows: repeat(9, 50px);
            gap: 1px;
            background-color: #000;
            padding: 2px;
            margin-bottom: 20px;
        }

        .cell {
            background-color: #f1f1f1;
            border: none;
            font-size: 24px;
            text-align: center;
            cursor: pointer;
        }

        .cell:hover {
            background-color: lightcyan;
        }

        .cell:focus {
            background-color: yellow;
            color: blue;
            outline: none;
        }

        .cell.initial {
            background-color: #e0e0e0;
            font-weight: bold;
        }

        /* Thicker borders for 3x3 boxes */
        .cell:nth-child(3n) {
            border-right: 2px solid #000;
        }

        .cell:nth-child(n+19):nth-child(-n+27),
        .cell:nth-child(n+46):nth-child(-n+54) {
            border-bottom: 2px solid #000;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #663399;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #552288;
        }

        #message {
            margin-bottom: 20px;
            padding: 10px;
            background-color: #fff;
            border-radius: 4px;
            min-height: 24px;
        }

        footer {
            margin-top: 30px;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>Sudoku Solver</h1>

    <div id="message">Click a cell and press a number key (1-9) to fill it. Press Space or Escape to clear.</div>

    <div id="sudoku-grid"></div>

    <div class="controls">
        <button id="load-sample">Load Sample</button>
        <button id="solve">Solve</button>
        <button id="reset">Reset</button>
    </div>

    <footer>Â© 2020, Developed by Devendra Phadke @ <a href="http://ridesoftech.com">Ride Softech</a></footer>

    <script>
        // Initialize 9x9 grid
        let grid = Array(9).fill().map(() => Array(9).fill(0));
        let initialCells = new Set();

        // Create grid cells
        const gridElement = document.getElementById('sudoku-grid');
        const cells = [];

        for (let i = 0; i < 81; i++) {
            const cell = document.createElement('input');
            cell.className = 'cell';
            cell.type = 'text';
            cell.maxLength = 1;
            cell.dataset.index = i;
            gridElement.appendChild(cell);
            cells.push(cell);

            cell.addEventListener('keydown', handleKeyPress);
            cell.addEventListener('input', handleInput);
        }

        function handleKeyPress(e) {
            const index = parseInt(e.target.dataset.index);
            const row = Math.floor(index / 9);
            const col = index % 9;

            if (e.key === 'Escape' || e.key === ' ') {
                e.preventDefault();
                if (!initialCells.has(index)) {
                    grid[row][col] = 0;
                    e.target.value = '';
                }
            }
        }

        function handleInput(e) {
            const index = parseInt(e.target.dataset.index);
            const row = Math.floor(index / 9);
            const col = index % 9;
            const value = e.target.value;

            if (initialCells.has(index)) {
                e.target.value = grid[row][col] || '';
                return;
            }

            if (value && /^[1-9]$/.test(value)) {
                const num = parseInt(value);
                if (isValidMove(row, col, num)) {
                    grid[row][col] = num;
                    e.target.value = num;
                } else {
                    showMessage('Invalid number for this position!');
                    e.target.value = '';
                    grid[row][col] = 0;
                }
            } else {
                e.target.value = '';
                grid[row][col] = 0;
            }
        }

        function isValidMove(row, col, num) {
            // Check row
            for (let c = 0; c < 9; c++) {
                if (c !== col && grid[row][c] === num) return false;
            }

            // Check column
            for (let r = 0; r < 9; r++) {
                if (r !== row && grid[r][col] === num) return false;
            }

            // Check 3x3 box
            const boxRow = Math.floor(row / 3) * 3;
            const boxCol = Math.floor(col / 3) * 3;
            for (let r = boxRow; r < boxRow + 3; r++) {
                for (let c = boxCol; c < boxCol + 3; c++) {
                    if (r !== row && c !== col && grid[r][c] === num) return false;
                }
            }

            return true;
        }

        function updateDisplay() {
            for (let i = 0; i < 81; i++) {
                const row = Math.floor(i / 9);
                const col = i % 9;
                cells[i].value = grid[row][col] || '';

                if (initialCells.has(i)) {
                    cells[i].classList.add('initial');
                } else {
                    cells[i].classList.remove('initial');
                }
            }
        }

        function showMessage(msg) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = msg;
            setTimeout(() => {
                messageEl.textContent = 'Click a cell and press a number key (1-9) to fill it. Press Space or Escape to clear.';
            }, 3000);
        }

        // Load Sample button
        document.getElementById('load-sample').addEventListener('click', () => {
            // Sample puzzle from the original code
            const sample = [
                [8, 0, 0, 0, 0, 0, 0, 0, 0],
                [0, 0, 3, 6, 0, 0, 0, 0, 0],
                [0, 7, 0, 0, 9, 0, 2, 0, 0],
                [0, 5, 0, 0, 0, 7, 0, 0, 0],
                [0, 0, 0, 0, 4, 5, 7, 0, 0],
                [0, 0, 0, 1, 0, 0, 0, 3, 0],
                [0, 0, 1, 0, 0, 0, 0, 6, 8],
                [0, 0, 8, 5, 0, 0, 0, 1, 0],
                [0, 9, 0, 0, 0, 0, 4, 0, 0]
            ];

            grid = sample.map(row => [...row]);
            initialCells.clear();

            for (let i = 0; i < 81; i++) {
                const row = Math.floor(i / 9);
                const col = i % 9;
                if (grid[row][col] !== 0) {
                    initialCells.add(i);
                }
            }

            updateDisplay();
            showMessage('Sample puzzle loaded!');
        });

        // Solve button
        document.getElementById('solve').addEventListener('click', () => {
            if (solveSudoku()) {
                updateDisplay();
                showMessage('Puzzle solved!');
            } else {
                showMessage('No solution exists for this puzzle!');
            }
        });

        // Reset button
        document.getElementById('reset').addEventListener('click', () => {
            grid = Array(9).fill().map(() => Array(9).fill(0));
            initialCells.clear();
            updateDisplay();
            showMessage('Grid reset!');
        });

        function solveSudoku() {
            const emptyCell = findEmptyCell();
            if (!emptyCell) return true; // Puzzle solved

            const [row, col] = emptyCell;

            for (let num = 1; num <= 9; num++) {
                if (isValidMove(row, col, num)) {
                    grid[row][col] = num;

                    if (solveSudoku()) {
                        return true;
                    }

                    grid[row][col] = 0;
                }
            }

            return false;
        }

        function findEmptyCell() {
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    if (grid[row][col] === 0) {
                        return [row, col];
                    }
                }
            }
            return null;
        }
    </script>
</body>
</html>
